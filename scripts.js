// Updated pinsData object with corrected syntax
const pinsData = {
    1839: [
        { x: 342, y: 2670, summary: "Lewis and Clark Expedition (1804-1806): The expedition mapped the Pacific Northwest and provided valuable information about the region.", link: "https://en.wikipedia.org/wiki/Lewis_and_Clark_Expedition" },
        { x: 550, y: 2575, summary: "Astoria Established (1811): John Jacob Astor's Pacific Fur Company established Astoria, the first American settlement on the Pacific coast.", link: "https://en.wikipedia.org/wiki/Astoria,_Oregon#History" },
        { x: 260, y: 2761, summary: "Oregon Trail (1830s): The establishment of the Oregon Trail facilitated westward migration and increased interest in the Pacific Northwest.", link: "https://en.wikipedia.org/wiki/Oregon_Trail" },
        { x: 462, y: 2775, summary: "Fort Vancouver (1824): The Hudson's Bay Company established Fort Vancouver, becoming a central hub for the fur trade in the region.", link: "https://en.wikipedia.org/wiki/Fort_Vancouver" },
        { x: 350, y: 2155, summary: "Treaty of 1818: This treaty allowed for joint occupation of the Oregon Territory by the United States and Great Britain, setting the stage for future negotiations and settlement.", link: "https://en.wikipedia.org/wiki/Treaty_of_1818" },
        { x: 100, y: 100, summary: "100 x 100" },
        { x: 300, y: 300, summary: "300 x 300" },
        { x: 500, y: 500, summary: "500 x 500" },
        { x: 1000, y: 1000, summary: "1000 x 1000" },
        { x: 2000, y: 2000, summary: "2000 x 2000" },
        { x: 1000, y: 100, summary: "1000 x 100" },
        { x: 100, y: 1000, summary: "100 x 1000" },
        { x: 4774, y: 3393, summary: "-100 x -100" },
        { x: 4574, y: 3193, summary: "-300 x -300" },
        { x: 4274, y: 2893, summary: "-600 x -600" },
        { x: 3874, y: 2493, summary: "-1000 x -1000" },
        { x: 2874, y: 3293, summary: "-2000 x -200" },
        { x: 0, y: 0, summary: "0 x 0" },
        { x: 4874, y: 3493, summary: "-0 x -0" },
        { x: 4974, y: 3593, summary: "+100 x +100" },
        { x: 3874, y: 2493, summary: "-1000 x -1000" },
        { x: 2874, y: 3293, summary: "-2000 x -200" }
    ],
    1855: [
        { x: 660, y: 730, summary: "Oregon Trail Peak Migration (1840-1860): Thousands of settlers traveled west, increasing demand for transportation and infrastructure.", link: "https://en.wikipedia.org/wiki/Oregon_Trail#Usage" },
        { x: 1475, y: 905, summary: "Whitman Mission Established (1836): Dr. Marcus Whitman established a mission in Walla Walla, fostering early settlement and conflict.", link: "https://en.wikipedia.org/wiki/Whitman_Mission" },
        { x: 1045, y: 1275, summary: "Oregon Territory Created (1848): The United States established the Oregon Territory, formalizing American claims in the region.", link: "https://en.wikipedia.org/wiki/Oregon_Territory" },
        { x: 630, y: 1775, summary: "California Gold Rush (1848-1855): The influx of people to California heightened interest in the Pacific Northwest as a transportation route.", link: "https://en.wikipedia.org/wiki/California_Gold_Rush" },
        { x: 800, y: 950, summary: "Donation Land Claim Act (1850): This act encouraged settlement in Oregon by offering land to pioneers, increasing population and economic activity.", link: "https://en.wikipedia.org/wiki/Donation_Land_Claim_Act" },
        { x: 1050, y: 945, summary: "Fort Dalles Established (1850): Fort Dalles served as a supply center and military post, aiding in the protection and development of the area.", link: "https://en.wikipedia.org/wiki/Fort_Dalles" },
        { x: 1050, y: 565, summary: "Pacific Railroad Surveys (1853-1855): Surveys were conducted to find the best routes for a transcontinental railroad, highlighting the importance of the Pacific Northwest.", link: "https://en.wikipedia.org/wiki/Pacific_Railroad_Surveys" },
        { x: 840, y: 565, summary: "Territory of Washington Created (1853): The creation of Washington Territory facilitated more focused governance and development efforts.", link: "https://en.wikipedia.org/wiki/Washington_Territory" },
        { x: 925, y: 560, summary: "Treaty of Medicine Creek (1854): This treaty with local Native American tribes aimed to secure land for settlers, though it led to significant conflict.", link: "https://en.wikipedia.org/wiki/Treaty_of_Medicine_Creek" },
        { x: 550, y: 600, summary: "Seattle Founded (1851): The establishment of Seattle as a key settlement marked the beginning of its growth into a major city.", link: "https://en.wikipedia.org/wiki/History_of_Seattle" },
        { x: 1125, y: 750, summary: "Yakima War (1855-1858): Conflict between settlers and the Yakama Nation over land and resources, impacting the stability and development of the region.", link: "https://en.wikipedia.org/wiki/Yakima_War" },
        { x: 885, y: 510, summary: "Puget Sound Agricultural Company (1852): Established by the Hudson's Bay Company, it played a significant role in the early economy of the region.", link: "https://en.wikipedia.org/wiki/Puget_Sound_Agricultural_Company" }
    ],
    1875: [
        { x: 1405, y: 1615, summary: "Northern Pacific Railway Chartered (1864): Congress chartered the Northern Pacific Railway to connect the Great Lakes with Puget Sound, stimulating investment and settlement.", link: "https://en.wikipedia.org/wiki/Northern_Pacific_Railway" },
        { x: 410, y: 1560, summary: "Oregon Steam Navigation Company (1860): This company was formed to control river transport in the region, crucial for moving goods and people.", link: "https://en.wikipedia.org/wiki/Oregon_Steam_Navigation_Company" },
        { x: 545, y: 3360, summary: "(Central California) Completion of the First Transcontinental Railroad (1869): This milestone increased national interest in connecting the Pacific Northwest to the broader rail network.", link: "https://en.wikipedia.org/wiki/First_transcontinental_railroad" },
        { x: 600, y: 1625, summary: "Columbia River Ferry Service (1879): This ferry connection facilitated transport across the Columbia River, enhancing connectivity in the region.", link: "https://www.historylink.org/File/20952" },
        { x: 630, y: 1750, summary: "Portland becomes a Major Rail Hub (1870s): Portland's strategic location on the Willamette River made it a key center for rail and shipping.", link: "https://en.wikipedia.org/wiki/History_of_Portland,_Oregon#Railroads_and_industrial_growth" },
        { x: 1030, y: 1340, summary: "Seattle and Walla Walla Railroad (1873): This railroad aimed to connect Seattle to the rich agricultural lands of Eastern Washington.", link: "https://en.wikipedia.org/wiki/Seattle_and_Walla_Walla_Railroad" },
        { x: 1430, y: 1110, summary: "Beginning of the Great Northern Railway (1879): James J. Hill began consolidating various rail lines, ultimately leading to the Great Northern Railway which would greatly impact the Pacific Northwest.", link: "https://en.wikipedia.org/wiki/Great_Northern_Railway_(U.S.)" },
        { x: 1990, y: 2380, summary: "Boise, Idaho, Founded (1863): The establishment of Boise as a key supply point for miners and settlers enhanced regional development.", link: "https://en.wikipedia.org/wiki/Boise,_Idaho#History" },
        { x: 865, y: 1740, summary: "Cascade Locks Construction (1878): The federal government constructed a system of canals and locks around the rough cascades of the Columbia river. All shipping previously had to portage (be carried over-land) around the rapids.", link: "https://www.oregonencyclopedia.org/articles/cascade_locks/" },
        { x: 560, y: 1940, summary: "Oregon and California Railroad (1869): This railroad connected Portland to San Francisco, boosting trade and travel.", link: "https://en.wikipedia.org/wiki/Oregon_and_California_Railroad" },
        { x: 720, y: 1245, summary: "Tacoma Founded (1864): The establishment of Tacoma as a port city was tied to its selection as the western terminus of the Northern Pacific Railway.", link: "https://en.wikipedia.org/wiki/Tacoma,_Washington#History" },
        { x: 200, y: 3370, summary: "(Central California) Transcontinental Telegraph (1861): The completion of the telegraph connected the Pacific Northwest to the rest of the country, facilitating communication.", link: "https://en.wikipedia.org/wiki/First_transcontinental_telegraph" }
    ],
    1900: [
        { x: 400, y: 450, summary: "Event 4", link: "/events/event4.html" },
    ],
    1921: [
        { x: 500, y: 550, summary: "Event 5", link: "/events/event5.html" },
    ],
    2000: [
        { x: 100, y: 100, summary: "100 x 100" },
        { x: 300, y: 300, summary: "300 x 300" },
        { x: 500, y: 500, summary: "500 x 500" },
        { x: 1000, y: 1000, summary: "1000 x 1000" },
        { x: 2000, y: 2000, summary: "2000 x 2000" },
        { x: 1000, y: 100, summary: "1000 x 100" },
        { x: 100, y: 1000, summary: "100 x 1000" }
    ]
};


// Updated mapImages object to store map images for different years
const mapImages = {
    1839: '../images/1839_crop.png',
    1855: '../images/1855_crop.png',
    1875: '../images/1875_crop.png',
    1900: '../images/1900_crop.png',
    1921: '../images/1921_crop.png',
    2000: '../images/2006_crop.png'
};

// Context information for each year
const contextData = {
    1839: `Prior to the late ninteenth century, the Pacific Northwest was largely inhabited by indigenous peoples who had thrived in the region for millennia. The area was characterized by dense forests, abundant wildlife, and a rugged landscape that presented both challenges and opportunities for exploration and settlement.`,
    1855: `The mid 19th century witnessed a significant increase in exploration and settlement in the Pacific Northwest. The Oregon Trail, established in the 1830s, facilitated the westward migration of settlers seeking land, economic opportunities, and a better life. This period also saw the signing of treaties between Indigenous tribes and the United States government, leading to the forced relocation of many Native American communities.`,
    1875: `After the development of the Oregon trail, rapid industrialization saw the expansion of transportation networks, particularly the construction of railways. The completion of the Transcontinental Railroad in 1869 connected the Pacific Northwest to the rest of the country, opening up new markets for goods and enabling the efficient transportation of people and resources across long distances.`,
    1900: `The late 19th century saw a period of immense growth and development in the Pacific Northwest, fueled by the expansion of railways and the rise of industries such as logging, mining, and agriculture. The influx of settlers, fueled by the promise of economic opportunities, led to the establishment of towns and cities throughout the region. However, this period also witnessed tensions between different groups vying for control over land and resources.`,
    1921: `The early 20th century marked a continuation of the economic and societal transformations initiated by the railway boom of the late 19th century. The Pacific Northwest experienced further urbanization and industrialization, as well as social and political changes driven by factors such as immigration, labor movements, and technological advancements. Despite challenges such as economic recessions and environmental degradation, the region continued to thrive and evolve.`,
    2000: `Population density of the Pacific Northwest in 2006.`
};

// Initialize the Leaflet map when the document is ready
document.addEventListener('DOMContentLoaded', () => {
    // Initialize the Leaflet map
    const map = L.map('map', {
        crs: L.CRS.Simple,
        minZoom: -2,
        maxZoom: 2,
        zoomSnap: 0.1,
        zoomDelta: 0.1,
    });

    // Define the image bounds (top-left and bottom-right corners)
    const imageBounds = [[0, 0], [5500, 6500]]; // Adjust these values to match your image dimensions

    // Add the initial image overlay
    const initialImageUrl = mapImages[1839];
    let imageLayer = L.imageOverlay(initialImageUrl, imageBounds).addTo(map);

    // Set the initial view to show the whole image
    map.fitBounds(imageBounds);

    // Function to show pins for the selected year and change the map image
    // Function to show pins for the selected year and change the map image
    function showYear(year) {
        console.log(`Showing information for the year ${year}`);
    
        // Change the map image
        imageLayer.setUrl(mapImages[year]);
    
        // Remove the .selected class from all buttons
        document.querySelectorAll('#map-controls button').forEach(button => {
            button.classList.remove('selected');
        });
    
        // Add the .selected class to the button corresponding to the selected year
        document.querySelector(`#map-controls button[data-year="${year}"]`).classList.add('selected');
    
        // Update the context information
        const contextDiv = document.getElementById('context');
        contextDiv.textContent = contextData[year]; // Make sure contextData is correctly defined
    
        // Clear existing pins
        map.eachLayer(layer => {
            if (layer instanceof L.Marker) {
                map.removeLayer(layer);
            }
        });
    
        // Add new pins for the selected year
        if (pinsData[year]) {
            pinsData[year].forEach(pin => {
                const marker = L.marker([pin.y, pin.x]).addTo(map);
                marker.bindPopup(`
                    <p>${pin.summary}</p>
                    <a href="${pin.link}">Learn more</a>
                `);
            });
        }
    }
    

    // Initialize with the first year
    showYear(1839);

    // Attach showYear function to window for button clicks
    window.showYear = showYear;
});
