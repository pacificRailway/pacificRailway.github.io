// Updated pinsData object with corrected syntax
const pinsData = {
    1839: [
        { x: 1230, y: 3700, summary: "Astoria Established (1811): John Jacob Astor's Pacific Fur Company established Astoria, the first American settlement on the Pacific coast.", link: "https://en.wikipedia.org/wiki/Astoria,_Oregon#History" },
        { x: 1700, y: 3230, summary: "Fort Vancouver (1824): The Hudson's Bay Company established Fort Vancouver, becoming a central hub for the fur trade in the region.", link: "https://en.wikipedia.org/wiki/Fort_Vancouver" },
        { x: 1850, y: 3100, summary: "Oregon Trail (1830s): The establishment of the Oregon Trail facilitated westward migration and increased interest in the Pacific Northwest.", link: "https://en.wikipedia.org/wiki/Oregon_Trail" },
        { x: 2375, y: 3495, summary: "Lewis and Clark Expedition (1804-1806): The expedition mapped the Pacific Northwest and provided valuable information about the region.", link: "https://en.wikipedia.org/wiki/Lewis_and_Clark_Expedition" },
        { x: 2400, y: 4800, summary: "Treaty of 1818: This treaty allowed for joint occupation of the Oregon Territory by the United States and Great Britain, setting the stage for future negotiations and settlement.", link: "https://en.wikipedia.org/wiki/Treaty_of_1818" }
    ],
    1855: [
        { x: 1400, y: 3000, summary: "Oregon Territory Created (1848): The United States established the Oregon Territory, formalizing American claims in the region.", link: "https://en.wikipedia.org/wiki/Oregon_Territory" },
        { x: 1400, y: 700, summary: "California Gold Rush (1848-1855): The influx of people to California heightened interest in the Pacific Northwest as a transportation route.", link: "https://en.wikipedia.org/wiki/California_Gold_Rush" },
        { x: 1500, y: 4030, summary: "Territory of Washington Created (1853): The creation of Washington Territory facilitated more focused governance and development efforts.", link: "https://en.wikipedia.org/wiki/Washington_Territory" },
        { x: 1600, y: 4050, summary: "Treaty of Medicine Creek (1854): This treaty with local Native American tribes aimed to secure land for settlers, though it led to significant conflict.", link: "https://en.wikipedia.org/wiki/Treaty_of_Medicine_Creek" },
        { x: 1600, y: 4150, summary: "Puget Sound Agricultural Company (1852): Established by the Hudson's Bay Company, it played a significant role in the early economy of the region.", link: "https://en.wikipedia.org/wiki/Puget_Sound_Agricultural_Company" },
        { x: 1700, y: 4300, summary: "Seattle Founded (1851): The establishment of Seattle as a key settlement marked the beginning of its growth into a major city.", link: "https://en.wikipedia.org/wiki/History_of_Seattle" },
        { x: 1900, y: 2400, summary: "Donation Land Claim Act (1850): This act encouraged settlement in Oregon by offering land to pioneers, increasing population and economic activity.", link: "https://en.wikipedia.org/wiki/Donation_Land_Claim_Act" },
        { x: 1900, y: 3000, summary: "Fort Dalles Established (1850): Fort Dalles served as a supply center and military post, aiding in the protection and development of the area.", link: "https://en.wikipedia.org/wiki/Fort_Dalles" },
        { x: 2400, y: 3200, summary: "Oregon Trail Peak Migration (1840-1860): Thousands of settlers traveled west, increasing demand for transportation and infrastructure.", link: "https://en.wikipedia.org/wiki/Oregon_Trail#Usage" },
        { x: 2400, y: 3370, summary: "Yakima War (1855-1858): Conflict between settlers and the Yakama Nation over land and resources, impacting the stability and development of the region.", link: "https://en.wikipedia.org/wiki/Yakima_War" },
        { x: 2825, y: 3100, summary: "Whitman Mission Establishment and Massacre (1836): Dr. Marcus Whitman established a mission in Walla Walla, fostering early settlement and conflict. Later the site of an infamous massacre which greatly spurred militarization in the region.", link: "https://en.wikipedia.org/wiki/Whitman_massacre" },
        { x: 5100, y: 4230, summary: "Pacific Railroad Surveys (1853-1855): Surveys were conducted to find the best routes for a transcontinental railroad, highlighting the importance of the Pacific Northwest.", link: "https://en.wikipedia.org/wiki/Pacific_Railroad_Surveys" },
        { x: 5100, y: 700, summary: "Pacific Railroad Surveys (1853-1855): Surveys were conducted to find the best routes for a transcontinental railroad, highlighting the importance of the Pacific Northwest.", link: "https://en.wikipedia.org/wiki/Pacific_Railroad_Surveys" }
    ],
    1875: [
        { x: 990, y: 3460, summary: "Tacoma Founded (1864): The establishment of Tacoma as a port city was tied to its selection as the western terminus of the Northern Pacific Railway.", link: "https://en.wikipedia.org/wiki/Tacoma,_Washington#History" },
        { x: 660, y: 1990, summary: "Oregon and California Railroad (1869): This railroad connected Portland to San Francisco, boosting trade and travel.", link: "https://en.wikipedia.org/wiki/Oregon_and_California_Railroad" },
        { x: 1420, y: 2650, summary: "Columbia River Ferry Service (1879): This ferry connection facilitated transport across the Columbia River, enhancing connectivity in the region.", link: "https://www.historylink.org/File/20952" },
        { x: 1400, y: 3330, summary: "Seattle and Walla Walla Railroad (1873): This railroad aimed to connect Seattle to the rich agricultural lands of Eastern Washington.", link: "https://en.wikipedia.org/wiki/Seattle_and_Walla_Walla_Railroad" },
        { x: 2725, y: 1600, summary: "Boise, Idaho, Founded (1863): The establishment of Boise as a key supply point for miners and settlers enhanced regional development.", link: "https://en.wikipedia.org/wiki/Boise,_Idaho#History" },
        { x: 210, y: 50, summary: "(Central California) Transcontinental Telegraph (1861): The completion of the telegraph connected the Pacific Northwest to the rest of the country, facilitating communication.", link: "https://en.wikipedia.org/wiki/First_transcontinental_telegraph" },
        { x: 2750, y: 3850, summary: "Beginning of the Great Northern Railway (1879): James J. Hill began consolidating various rail lines, ultimately leading to the Great Northern Railway which would greatly impact the Pacific Northwest.", link: "https://en.wikipedia.org/wiki/Great_Northern_Railway_(U.S.)" },
        { x: 3400, y: 3420, summary: "Northern Pacific Railway Chartered (1864): Congress chartered the Northern Pacific Railway to connect the Great Lakes with Puget Sound, stimulating investment and settlement.", link: "https://en.wikipedia.org/wiki/Northern_Pacific_Railway" },
        { x: 720, y: 50, summary: "(Central California) Completion of the First Transcontinental Railroad (1869): This milestone increased national interest in connecting the Pacific Northwest to the broader rail network.", link: "https://en.wikipedia.org/wiki/First_transcontinental_railroad" },
        { x: 500, y: 2990, summary: "Oregon Steam Navigation Company (1860): This company was formed to control river transport in the region, crucial for moving goods and people.", link: "https://en.wikipedia.org/wiki/Oregon_Steam_Navigation_Company" },
        { x: 1065, y: 2640, summary: "Cascade Locks Construction (1878): The federal government constructed a system of canals and locks around the rough cascades of the Columbia river. All shipping previously had to portage (be carried over-land) around the rapids.", link: "https://www.oregonencyclopedia.org/articles/cascade_locks/" },
        { x: 750, y: 2630, summary: "Portland becomes a Major Rail Hub (1870s): Portland's strategic location on the Willamette River made it a key center for rail and shipping.", link: "https://en.wikipedia.org/wiki/History_of_Portland,_Oregon#Railroads_and_industrial_growth" }
    ],
    1900: [
        { x: 2550, y: 2550, summary: "Completion of the Oregon Transcontinental Railroad (1883): Linked the Pacific Northwest with the eastern United States, spurring economic growth.", link: "https://en.wikipedia.org/wiki/Oregon_Railway_and_Navigation_Company" },
        { x: 2525, y: 4440, summary: "Spokane Fire (1889): Devastating fire that led to significant reconstruction efforts and urban planning strategies in Spokane.", link: "https://en.wikipedia.org/wiki/History_of_Spokane,_Washington" },
        { x: 950, y: 2900, summary: "Founding of the Oregon Railroad and Navigation Company (1896): Played a crucial role in developing transportation infrastructure in the Pacific Northwest.", link: "https://en.wikipedia.org/wiki/Oregon_Railroad_and_Navigation_Company" },
        { x: 1400, y: 4450, summary: "Construction of the Cascade Tunnel (1890-1893): Provided a vital transportation link for the Great Northern Railway.", link: "https://en.wikipedia.org/wiki/Cascade_Tunnel" },
        { x: 1080, y: 4340, summary: "Seattle's Denny Regrade (1897-1911): The excavation of hills and filling of waterfronts radically altered Seattle's landscape, facilitating urban development and improving transportation routes.", link: "https://en.wikipedia.org/wiki/Denny_Regrade" },
        { x: 2800, y: 4800, summary: "Rapid expansion of the Northern Pacific Railway (1870s-1890s): Opened up new areas for settlement and contributed to economic growth.", link: "https://en.wikipedia.org/wiki/Northern_Pacific_Railway" },
        { x: 4100, y: 3700, summary: "Creation of the Coeur d'Alene Railway and Navigation Company (1898): Played a key role in developing transportation infrastructure in northern Idaho and Montana.", link: "https://www.historylink.org/File/7528" },
        { x: 1115, y: 4370, summary: "Seattle Fire (1889): Devastating fire that destroyed much of downtown Seattle, leading to significant reconstruction efforts.", link: "https://en.wikipedia.org/wiki/History_of_Seattle#Great_Seattle_Fire_of_1889" },
        { x: 990, y: 3100, summary: "First Telegraph Line Established in Portland (1861): Connected the Pacific Northwest to the rest of the country, facilitating communication and commerce.", link: "https://en.wikipedia.org/wiki/First_transcontinental_telegraph" },
        { x: 200, y: 5000, summary: "(Alaska) Klondike Gold Rush (1896-1899): Sparked a massive influx of people to the Pacific Northwest, particularly Seattle, and stimulated regional economic growth.", link: "https://en.wikipedia.org/wiki/Klondike_Gold_Rush" }
    ],
    1921: [
        { x: 700, y: 2550, summary: "Completion of the Columbia River Railroad Bridge (1908): This bridge, connecting Portland, Oregon to Vancouver, Washington, facilitated rail traffic across the Columbia River, boosting trade and transportation in the region.", link: "https://en.wikipedia.org/wiki/Columbia_River_(Oregon%E2%80%93Washington)#Crossings" },
        { x: 835, y: 3500, summary: "Founding of the Port of Seattle (1911): Established to manage Seattle's harbor and promote trade, the Port of Seattle played a crucial role in developing the region's maritime infrastructure and economy.", link: "https://en.wikipedia.org/wiki/Port_of_Seattle" },
        { x: 1540, y: 2730, summary: "Completion of the Spokane, Portland & Seattle Railway (1908): This railway connected Spokane, Washington to Portland, Oregon, enhancing regional connectivity and economic growth.", link: "https://en.wikipedia.org/wiki/Spokane,_Portland_and_Seattle_Railway" },
        { x: 700, y: 2460, summary: "Construction of the Union Station in Portland (1908): The completion of Union Station solidified Portland's status as a major transportation hub in the Pacific Northwest.", link: "https://en.wikipedia.org/wiki/Union_Station_(Portland,_Oregon)" },
        { x: 100, y: 3700, summary: "(Alaska) Establishment of the Alaska Steamship Company (1894-1912): While founded earlier, this company expanded significantly in the early 20th century, providing vital maritime links between Seattle and Alaska, boosting trade and transport.", link: "https://en.wikipedia.org/wiki/Alaska_Steamship_Company" },
        { x: 1900, y: 3125, summary: "Completion of the Chicago, Milwaukee, St. Paul and Pacific Railroad's Pacific Extension (1909): Known as the 'Milwaukee Road,' this line connected Chicago to Seattle and Tacoma, increasing competition and improving rail service in the region.", link: "https://en.wikipedia.org/wiki/Milwaukee_Road_Pacific_Extension" },
        { x: 835, y: 3410, summary: "Opening of the Smith Tower in Seattle (1914): As the tallest building in Seattle at the time, Smith Tower symbolized the city's economic growth and modernization.", link: "https://en.wikipedia.org/wiki/Smith_Tower" },
        { x: 680, y: 2450, summary: "Completion of the North Bank Depot (1911): This depot in Portland served as a critical passenger and freight hub, enhancing rail connectivity.", link: "https://en.wikipedia.org/wiki/Portland_Union_Station" },
        { x: 700, y: 2500, summary: "Establishment of the Port of Portland (1891, expanded 1909): The port's expansion in the early 20th century played a significant role in the city's economic development.", link: "https://en.wikipedia.org/wiki/Port_of_Portland_(Oregon)" },
        { x: 850, y: 3380, summary: "Formation of the Seattle-Tacoma Interurban Railway (1902): This electric railway connected Seattle and Tacoma, facilitating commuter and freight transport.", link: "https://en.wikipedia.org/wiki/Puget_Sound_Electric_Railway" },
        { x: 900, y: 3100, summary: "Opening of the Tacoma Union Station (1911): This grand station served as a key rail hub for Tacoma, promoting regional connectivity and economic development.", link: "https://en.wikipedia.org/wiki/Union_Station_(Tacoma,_Washington)" },
        { x: 1700, y: 2900, summary: "Construction of the Columbia Basin Project (began in 1918): A large-scale irrigation project in central Washington, aimed at transforming arid land into fertile agricultural land.", link: "https://en.wikipedia.org/wiki/Columbia_Basin_Project" },
        { x: 840, y: 3460, summary: "Establishment of Boeing in Seattle (1916): Founded by William Boeing, this company would become a major employer and economic driver in the region.", link: "https://en.wikipedia.org/wiki/Boeing" },
        { x: 825, y: 3410, summary: "Completion of the Lake Washington Ship Canal (1917): This canal linked Lake Washington with Puget Sound, significantly improving maritime navigation and boosting Seattle's port facilities.", link: "https://en.wikipedia.org/wiki/Lake_Washington_Ship_Canal" },
        { x: 830, y: 3460, summary: "Seattle General Strike (1919): The first general strike in the United States, it demonstrated the growing power and organization of labor unions in the Pacific Northwest.", link: "https://en.wikipedia.org/wiki/Seattle_General_Strike" },
        { x: 1400, y: 3400, summary: "Expansion of the Great Northern Railway (1900-1921): Continued expansion and improvement of the Great Northern Railway enhanced regional connectivity and economic growth.", link: "https://en.wikipedia.org/wiki/Great_Northern_Railway_(U.S.)" },
        { x: 2160, y: 4080, summary: "Construction of the Spokane International Railroad (1906): Provided a critical rail link between Spokane and the Canadian Pacific Railway, enhancing international trade.", link: "https://en.wikipedia.org/wiki/Spokane_International_Railroad" },
        { x: 1200, y: 2480, summary: "Establishment of the Bonneville Power Administration (1937, with precursors in the 1920s): While officially established later, the groundwork for this key agency in managing regional hydroelectric power began in the early 20th century.", link: "https://en.wikipedia.org/wiki/Bonneville_Power_Administration" },
        { x: 800, y: 2650, summary: "Expansion of the timber industry (early 1900s): The growth of the timber industry in Oregon and Washington, facilitated by railroads, significantly boosted the regional economy.", link: "https://en.wikipedia.org/wiki/History_of_the_United_States_forest_industry" }
    ],
    2000: [

    ]
};


// Updated mapImages object to store map images for different years
const mapImages = {
    1839: '../images/1839_crop.png',
    1855: '../images/1855_crop.png',
    1875: '../images/1875_crop.png',
    1900: '../images/1900_crop.png',
    1921: '../images/1921_crop.png',
    2000: '../images/2006_crop.png'
};

// Context information for each year
const contextData = {
    1839: `Prior to the late ninteenth century, the Pacific Northwest was largely inhabited by indigenous peoples who had thrived in the region for millennia. The area was characterized by dense forests, abundant wildlife, and a rugged landscape that presented both challenges and opportunities for exploration and settlement.`,
    1855: `The mid 19th century witnessed a significant increase in exploration and settlement in the Pacific Northwest. The Oregon Trail, established in the 1830s, facilitated the westward migration of settlers seeking land, economic opportunities, and a better life. This period also saw the signing of treaties between Indigenous tribes and the United States government, leading to the forced relocation of many Native American communities.`,
    1875: `After the development of the Oregon trail, rapid industrialization saw the expansion of transportation networks, particularly the construction of railways. The completion of the Transcontinental Railroad in 1869 connected the Pacific Northwest to the rest of the country, opening up new markets for goods and enabling the efficient transportation of people and resources across long distances.`,
    1900: `The late 19th century saw a period of immense growth and development in the Pacific Northwest, fueled by the expansion of railways and the rise of industries such as logging, mining, and agriculture. The influx of settlers, fueled by the promise of economic opportunities, led to the establishment of towns and cities throughout the region. However, this period also witnessed tensions between different groups vying for control over land and resources.`,
    1921: `The early 20th century marked a continuation of the economic and societal transformations initiated by the railway boom of the late 19th century. The Pacific Northwest experienced further urbanization and industrialization, as well as social and political changes driven by factors such as immigration, labor movements, and technological advancements. Despite challenges such as economic recessions and environmental degradation, the region continued to thrive and evolve.`,
    2000: `Population density of the Pacific Northwest in 2006.`
};

// Initialize the Leaflet map when the document is ready
document.addEventListener('DOMContentLoaded', () => {
    // Initialize the Leaflet map
    const map = L.map('map', {
        crs: L.CRS.Simple,
        minZoom: -2,
        maxZoom: 2,
        zoomSnap: 0.1,
        zoomDelta: 0.1,
    });

    // Define the image bounds (top-left and bottom-right corners)
    const imageBounds = [[0, 0], [5500, 6500]]; // Adjust these values to match your image dimensions

    // Add the initial image overlay
    const initialImageUrl = mapImages[1839];
    let imageLayer = L.imageOverlay(initialImageUrl, imageBounds).addTo(map);

    // Set the initial view to show the whole image
    map.fitBounds(imageBounds);

    // Function to show pins for the selected year and change the map image
    // Function to show pins for the selected year and change the map image
    function showYear(year) {
        console.log(`Showing information for the year ${year}`);
    
        // Change the map image
        imageLayer.setUrl(mapImages[year]);
    
        // Remove the .selected class from all buttons
        document.querySelectorAll('#map-controls button').forEach(button => {
            button.classList.remove('selected');
        });
    
        // Add the .selected class to the button corresponding to the selected year
        document.querySelector(`#map-controls button[data-year="${year}"]`).classList.add('selected');
    
        // Update the context information
        const contextDiv = document.getElementById('context');
        contextDiv.textContent = contextData[year]; // Make sure contextData is correctly defined
    
        // Clear existing pins
        map.eachLayer(layer => {
            if (layer instanceof L.Marker) {
                map.removeLayer(layer);
            }
        });
    
        // Add new pins for the selected year
        if (pinsData[year]) {
            pinsData[year].forEach(pin => {
                const marker = L.marker([pin.y, pin.x]).addTo(map);
                marker.bindPopup(`
                    <p>${pin.summary}</p>
                    <a href="${pin.link}">Learn more</a>
                `);
            });
        }
    }
    

    // Initialize with the first year
    showYear(1839);

    // Attach showYear function to window for button clicks
    window.showYear = showYear;
});
